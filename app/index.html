<!doctype html>
<html class="no-js">
  <head>
    <meta charset="utf-8">
    <title>swagger fake server</title>
  </head>
  <body>
    <h1>Swagger Fake Server</h1>
    <!-- build:js(.) scripts/vendor.js -->
    <!-- bower:js -->
    <script src="bower_components/sinon/index.js"></script>
    <!-- endbower -->
    <!-- endbuild -->

    <!-- build:js({app,.tmp}) scripts/main.js -->
    <script src="scripts/main.js"></script>
    <!-- endbuild -->

    <script type="text/javascript">

      var ajax = function(url, successful, unsuccessful) {
        var xhr;
        xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
          var error, json;
          if (xhr.readyState === 4) {
            if (xhr.status === 200) {
              successful(xhr.responseText);
            } else {
              unsuccessful(xhr.statusText);
            }
          }
        };
        xhr.open('GET', url, true);
        xhr.responseType = 'text';
        return xhr.send();
      };

      var testAjax = function () {
        var urls = [
          'https://api.uber.com/v1/estimates/price',
          'https://api.uber.com/v1/estimates/time',
          'https://api.uber.com/v1/products',
          'https://api.uber.com/v1/batman',
          'http://echo.jsontest.com/key/value/one/two'
        ];

        for (var i = 0; i < urls.length; i += 1) {
          url = urls[i];

          console.log('-> Requesting ' + url);

          ajax(url, function (text) {
            console.log('Successful response from ' + url + ': ' + text);
          }, function (text) {
            console.log('Unsuccessful response from ' + url + ': ' + text);
          });
        }
      };

      var uber_swag, lyft_swag;

      uber_swag = new SwaggerFakeServer('uber.swagger.json', {
        callback: function () {
          lyft_swag = new SwaggerFakeServer('lyft.swagger.json', {
            callback: testAjax
          });
        }
      });

    </script>
  </body>
</html>
